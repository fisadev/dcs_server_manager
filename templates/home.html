<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DCS Server Manager</title>
    <link rel="icon" href="{{ url_for('static', filename='icon.png') }}">
    <link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script src="{{ url_for('static', filename='htmx_2.0.4.min.js') }}"></script>
</head>
<body>
    <div class="sidebar">
        <img class="main-logo" src="{{ url_for('static', filename='icon.png') }}" alt="Icon">
        <h1>DCS Server Manager</h1>
        <button class="nav-link" data-target="dcs-section" onclick="showSection('dcs-section')">
            DCS
            <span id="dcs-status-icon" hx-get="/dcs/status/icon" hx-trigger="load, every 5s" hx-target="#dcs-status-icon" hx-swap="innerHTML">
            </span> 
        </button>
        <button class="nav-link" data-target="srs-section" onclick="showSection('srs-section')">
            SRS
            <span id="srs-status-icon" hx-get="/srs/status/icon" hx-trigger="load, every 5s" hx-target="#srs-status-icon" hx-swap="innerHTML">
            </span> 
        </button>
        <button class="nav-link" data-target="logs-section" onclick="showSection('logs-section')">Logs</button>
    </div>

    <div class="main-content">
        <div class="section" id="dcs-section">
            <div class="section-content">
                <h2>DCS Server:
                    <span id="dcs-status" hx-get="/dcs/status" hx-trigger="load, every 5s" hx-target="#dcs-status" hx-swap="innerHTML">
                        Loading status...
                    </span> 
                </h2>
                <div class="button-group">
                    <button class="btn-normal" hx-get="/dcs/start" hx-trigger="click" hx-target="#dcs-status" hx-swap="innerHTML">Start Server</button>
                    <button class="btn-normal" hx-get="/dcs/restart" hx-trigger="click" hx-target="#dcs-status" hx-swap="innerHTML">Restart Server</button>
                    <button class="btn-red" hx-get="/dcs/kill" hx-trigger="click" hx-target="#dcs-status" hx-swap="innerHTML">Kill Server</button>
                </div>

                <div class="foldable-section">
                    <h3 class="foldable-title" onclick="toggleFoldable(this)">
                        <span class="icon">▼</span>
                        Manager settings
                    </h3>
                    <div class="foldable-content">
                        <div id="dcs-manager-config" hx-get="/dcs/manager_config_form" hx-trigger="load" hx-target="#dcs-manager-config" hx-swap="innerHTML">
                            Loading config...
                        </div>
                        <div class="button-group">
                            <button class="btn-normal" hx-post="/dcs/manager_config_form" hx-trigger="click" hx-target="#dcs-manager-config" hx-include="#dcs-manager-config-form">Apply Manager Config</button>
                            <button class="btn-normal" hx-get="/dcs/manager_config_form" hx-trigger="click" hx-target="#dcs-manager-config">Undo unsaved changes</button>
                            <button class="btn-normal">Pause Checks</button>
                            <button class="btn-normal">Resume Checks</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section-content">
                <h2>Mission Files</h2>
                <p>...</p>
                <div class="button-group">
                    <button class="btn-normal">Upload Mission File</button>
                </div>
            </div>

            <div class="section-content">
                <h2>Track Files</h2>
                <p>...</p>
                <div class="button-group">
                    <button class="btn-red">Delete All</button>
                </div>
            </div>

            <div class="section-content">
                <h2>DCS Server Configuration</h2>
                <textarea id="dcs-config-editor" class="config-editor" hx-get="/config" hx-trigger="load" hx-target="#dcs-config-editor" hx-swap="innerHTML">
                    Loading configuration...
                </textarea>
                <div class="button-group">
                    <button class="btn-normal">Save</button>
                    <button class="btn-normal">Undo unsaved changes</button>
                </div>
            </div>
        </div>

        <div class="section" id="srs-section">
            <div class="section-content">
                <h2>SRS Server:
                    <span id="srs-status" hx-get="/srs/status" hx-trigger="load, every 5s" hx-target="#srs-status" hx-swap="innerHTML">
                        Loading status...
                    </span>
                </h2>
                <div class="button-group">
                    <button class="btn-normal" hx-get="/srs/start" hx-trigger="click" hx-target="#srs-status" hx-swap="innerHTML">Start Server</button>
                    <button class="btn-normal" hx-get="/srs/restart" hx-trigger="click" hx-target="#srs-status" hx-swap="innerHTML">Restart Server</button>
                    <button class="btn-red" hx-get="/srs/kill" hx-trigger="click" hx-target="#srs-status" hx-swap="innerHTML">Kill Server</button>
                </div>

                <div class="foldable-section">
                    <h3 class="foldable-title" onclick="toggleFoldable(this)">
                        <span class="icon">▼</span>
                        Manager settings
                    </h3>
                    <div class="foldable-content">
                        <div id="srs-manager-config" hx-get="/srs/manager_config_form" hx-trigger="load" hx-target="#srs-manager-config" hx-swap="innerHTML">
                            Loading config...
                        </div>
                        <div class="button-group">
                            <button class="btn-normal" hx-post="/srs/manager_config_form" hx-trigger="click" hx-target="#srs-manager-config" hx-include="#srs-manager-config-form">Apply Manager Config</button>
                            <button class="btn-normal" hx-get="/srs/manager_config_form" hx-trigger="click" hx-target="#srs-manager-config">Undo unsaved changes</button>
                            <button class="btn-normal">Pause Checks</button>
                            <button class="btn-normal">Resume Checks</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section-content">
                <h2>SRS Server Configuration</h2>
                <textarea id="srs-config-editor" class="config-editor" hx-get="/config" hx-trigger="load" hx-target="#srs-config-editor" hx-swap="innerHTML">
                    Loading configuration...
                </textarea>
                <div class="button-group">
                    <button class="btn-normal">Save</button>
                    <button class="btn-normal">Undo unsaved changes</button>
                </div>
            </div>
        </div>
  
        <div class="section" id="logs-section">
            <div class="section-content">
                <h2>Logs</h2>
                <pre id="logs" class="scroll-box">
                    (click on refresh to load logs)
                </pre>
                <div class="button-group">
                    <button class="btn-normal" hx-get="/logs" hx-trigger="click" hx-target="#logs" hx-swap="innerHTML">Refresh</button>
                    <button class="btn-red" hx-get="/logs/delete" hx-trigger="click" hx-target="#logs" hx-swap="innerHTML">Delete Logs</button>
                </div>
            </div>
        </div>
    </div>
  
    <script>
        function showSection(id) {
            document.querySelectorAll('.section').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.nav-link').forEach(el => el.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            document.querySelector(`.nav-link[data-target="${id}"]`).classList.add('active');
        }
  
        document.addEventListener('DOMContentLoaded', () => {
            showSection('dcs-section');
        });

        function toggleFoldable(titleElement) {
            const content = titleElement.nextElementSibling;

            content.classList.toggle('open');
            titleElement.classList.toggle('open');
        }
    </script>
</body>
</html>

